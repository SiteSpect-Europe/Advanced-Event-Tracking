/**
* SiteSpect Advanced Event Tracking
* Copyright 2020, SiteSpect Europe. All Rights Reserved.
* V1.0.10
*/
var _stsp=_stsp||[];window.SS=window.SS||{},window.SS.Tracking={isDebug:function(){return!!window.SS.Tracking.debug},isPreview:function(){return!!window.ssp_current_data},eventHandlers:[],enumerate:function(e){for(var t=document.querySelectorAll(e),n=0;n<t.length;n++)t[n].setAttribute("stsp-sequence",n+1)},hash:function(e){var t,n,r=1,c=0;if(e)for(r=0,t=e.length-1;0<=t;t--)r=0!==(c=266338304&(r=(r<<6&268435455)+(n=e.charCodeAt(t))+(n<<14)))?r^c>>21:r;return String(r)},sendXHR:function(e,o){var a=window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLHTTP"):new window.XMLHttpRequest;o=o||[];try{a.open("GET",e),window.SS.Tracking.isPreview()&&(a.onreadystatechange=function(e,t,n){if(a.readyState==a.HEADERS_RECEIVED&&a.getResponseHeader("SiteSpect-Metrics-Info")){var r=a.getResponseHeader("SiteSpect-Metrics-Info"),c=JSON.parse(r),i={};for(id in c)newid=id+"-"+window.SS.Tracking.hash(o.join("&")),i[newid]={},Object.assign(i[newid],c[id]),i[newid].ID=newid,o.length&&(i[newid].Name+="<br/>AET: "+o.join(", "));r=JSON.stringify(i),function e(t,n){document.querySelector(".dx-pane--diagnostics .dx-pane--dx-table")?__preview_history.add_event_track_metric(r,"Metric (EventTrack)"):setTimeout(function(){e(t,n)},100)}(a,a)}})}catch(e){return!1}try{a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("Accept","*/*"),a.send(null)}catch(e){return!1}},sendBeacon:function(t){navigator&&navigator.sendBeacon||window.SS.Tracking.sendXHR(t);try{navigator.sendBeacon(t)}catch(e){window.SS.Tracking.sendXHR(t),console.log("error sending beacon!",e)}},send:function(e,t,n){for(var r=[],c=Object.entries(e),i=0;i<c.length;i++){var o=c[i],a=o[0],s=o[1],l="";-1<["selector","filter","match","event","callback","form","delay","track"].indexOf(a)||(l="enumerate"==a?"sequence="+t.getAttribute("stsp-sequence"):"function"==typeof s?a+"="+s(t,n||!1):a+"="+s,r.push(l))}r.sort();var u="/__ssobj/track?event="+("function"==typeof e.event?e.event(t):e.event)+(r.length?"&"+r.join("&"):"")+"&x="+Math.floor(99999999*Math.random())+"-1";try{window.SS.Tracking.isPreview()||window.SS.Tracking.isDebug()?(console.log(u),window.SS.Tracking.sendXHR(u,r)):window.SS.Tracking.sendBeacon(u)}catch(e){if(1&e.number)return!1}return!0},matcher:function(e){return!Object.entries(e).filter(function(e){var t=e[0],n=e[1];switch(t){case"hostname":case"pathname":case"href":case"host":case"hash":case"search":return!new RegExp(n).test(document.location[t]);case"cookie":return!new RegExp(n).test(document.cookie)}}).length},process:function(t){t.enumerate&&window.SS.Tracking.enumerate(t.selector),t.form||t.selector||t.filter&&!t.filter(t)||t.match&&!window.SS.Tracking.matcher(t.match)||(window.SS.Tracking.send(t,null),t.callback&&t.callback(t)),t.track&&this.listenToEvent(t.track,function(e){window.SS.Tracking.checkEventSend(t.track,e.target,e)})},setup:function(){for(var e=0;e<_stsp.length;e++)window.SS.Tracking.process(_stsp[e]);this.listenToEvent("click",function(e){window.SS.Tracking.checkEventSend("click",e.target,e)}),this.listenToEvent("submit",function(e){window.SS.Tracking.checkEventSend("submit",e.target,e)}),_stsp.push=function(e){window.SS.Tracking.process(e),Array.prototype.push.call(this,e)}},checkEventSend:function(e,t,r){function n(e,t){var n=t.closest(e.selector);!n.getAttribute("stsp-sequence")&&e.enumerate&&window.SS.Tracking.enumerate(e.selector),e.filter&&!e.filter(n,r)||(window.SS.Tracking.send(e,n,r||!1),e.callback&&e.callback(e,r))}for(var c=0;c<_stsp.length;c++){var i=_stsp[c];if(i.event&&(!i.track||i.track===e)&&(!i.track||i.track===e)){if("submit"===e){if(!i.form||!t.matches(i.form))continue;i.selector=i.form}i.selector&&t.matches(i.selector+","+i.selector+" *")&&("change"===e&&(i.value=t.value),i.form&&"click"===e&&"click"!==i.track||i.match&&!window.SS.Tracking.matcher(i.match)||(i.delay?setTimeout(function(e){n(e.item,e.target)},i.delay,{item:i,target:t}):n(i,t)))}}},isListening:function(t){return this.eventHandlers.filter(function(e){return e.type===t}).length},listenToEvent:function(e,t){if(!this.isListening(e)){var n=document.addEventListener(e,function(e){e.target&&t(e)});this.eventHandlers.push({type:e,handler:n})}}},Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;0<=--n&&t.item(n)!==this;);return-1<n}),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}),Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},writable:!0,configurable:!0}),window.SS.Tracking.setup();